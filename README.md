# Полная логика программы от запуска до завершения

---

## **1. Запуск программы**

### **1.1. Проверка файла**
- Программа проверяет наличие файла `_register_test.xlsx` в текущей папке (где находится `.exe` файл программы).
  - **Если файл найден:**
    - Выводит сообщение: `"Файл _register_test.xlsx обнаружен."`
  - **Если файл не найден:**
    - Выводит сообщение: `"Файл _register_test.xlsx не найден. Введите абсолютный путь к файлу:"`
    - Пользователь вводит путь.
    - Программа проверяет, существует ли файл и является ли он Excel-файлом. Если нет, повторяет запрос.

---

### **1.2. Ввод ключевого слова**
- Программа выводит инструкцию: `"Введите слово 'реестр':"`
  - **Если пользователь ввёл "реестр":** программа продолжает выполнение.
  - **Если слово введено неверно:** программа выводит: `"Нет, именно 'реестр':)"` и повторяет запрос.

---

## **2. Главное меню**

### **2.1. Структура меню**
Программа отображает меню:

    Главное меню:

   1. Открыть реестр в Excel
   2. Добавить запись
   3. Изменить запись
   4. Настроить таблицу
   5. Выход

---

### **2.2. Логика пунктов меню**

#### **1. Открыть реестр в Excel**
- Программа выводит сообщение: `"Открываю файл _register_test.xlsx..."`.
- Пытается открыть файл с помощью системной команды.
- **Если файл не удаётся открыть:** программа выводит сообщение об ошибке.

#### **2. Добавить запись**
- Вызывает логику добавления новой записи:
  - Обработка каждого столбца в соответствии с их логикой.
  - После ввода последнего столбца:
    - Программа выводит заполненные поля для проверки.
    - Спрашивает: `"Сохранить изменения? (1 - 'Да', 2 - 'Редактировать'):"`
      - **Если пользователь выбирает `1`:**
        - Сохраняет данные в таблицу.
        - Возвращается в главное меню.
      - **Если пользователь выбирает `2`:**
        - Переходит в режим редактирования.

#### **3. Изменить запись**
- Программа отображает список всех записей с их порядковыми номерами.
- Пользователь выбирает номер записи для редактирования.
- Логика редактирования:
  - Вывод всех полей выбранной записи с текущими значениями.
  - Пользователь может выбрать номер поля для редактирования.
  - После изменения программа снова отображает все поля и спрашивает, сохранить ли изменения.

#### **4. Настроить таблицу**
- Предлагает пользователю следующие действия:
  - **Добавить новый столбец.**
    - Запрашивает название столбца.
    - Добавляет столбец в конец таблицы.
  - **Переименовать существующий столбец.**
    - Выводит список столбцов.
    - Пользователь выбирает столбец для переименования.
    - Запрашивает новое имя для столбца.

#### **5. Выход**
- Программа выводит сообщение: `"Выход из программы. До свидания!"`
- Завершает выполнение.

---

## **3. Логика добавления записи**

### **3.1. Общие шаги**
- Программа находит первую пустую строку в таблице.
- Последовательно обрабатывает все столбцы, запрашивая у пользователя ввод.

---

### **3.2. Логика по столбцам**

### **A: Опубликовано на Tilda**
- **Тип данных:** Да/Нет.
- **Логика:**
  1. Программа запрашивает:  
     `"Опубликовано на Tilda? (1 - 'Нет', 2 - 'Да'):"`
  2. Если пользователь вводит `1` или `2`, значение сохраняется как "Нет" или "Да".
  3. Если ввод некорректный, программа выводит сообщение:  
     `"Некорректный ввод. Введите 1 (Нет) или 2 (Да)."`

---

### **B: Опубликовано в СДО**
- **Тип данных:** Да/Нет.
- **Логика:**  
  Аналогично столбцу A.

---

### **C: Полное название материала**
- **Тип данных:** Текст (обязательно).
- **Логика:**
  1. Программа запрашивает:  
     `"Введите полное название материала:"`
  2. Если поле оставлено пустым, программа выводит:  
     `"Это поле обязательно. Введите полное название материала."`  
     и повторяет запрос.

---

### **D: Аннотация - полный текст**
- **Тип данных:** Текст (обязательно).
- **Логика:**  
  Аналогично столбцу C.

---

### **E: Аннотация (макс. 250 символов)**
- **Тип данных:** Текст (обязательно, максимум 250 символов).
- **Логика:**
  1. Программа запрашивает:  
     `"Введите краткую аннотацию (макс. 250 символов):"`
  2. Если текст превышает 250 символов, программа выводит:  
     `"Аннотация не может быть длиннее 250 символов."`  
     и повторяет запрос.

---

### **F: Раздел**
- **Тип данных:** Выбор из списка (обязательно).
- **Логика:**
  1. Программа выводит список разделов:
     ```
     1. Банк практик
     2. Видеолекции
     3. Видеоматериалы
     4. Жизненные ситуации
     5. Инструкция по внедрению
     6. Исследования и обзоры
     7. Публикации
     8. Отечественный опыт
     9. Международный опыт
     10. Иное
     ```
  2. Пользователь выбирает номер раздела.
  3. Если выбран "Иное", программа запрашивает уточнение:  
     `"Введите название для 'Иное':"`
  4. Если ввод некорректный, программа выводит:  
     `"Некорректный выбор. Введите номер из списка."`

---

### **G: Серия (при наличии)**
- **Тип данных:** Текст (необязательное поле).
- **Логика:**
  1. Программа запрашивает:  
     `"Введите серию (или оставьте пустым):"`
  2. Пользователь может нажать Enter, чтобы оставить поле пустым.

---

### **H: Дата создания**
- **Тип данных:** Дата (необязательное поле).
- **Логика:**
  1. Программа запрашивает:  
     `"Введите дату создания (в формате ДД-ММ-ГГГГ) или оставьте пустым:"`
  2. Если формат неверный, программа выводит:  
     `"Некорректный формат даты. Введите дату в формате ДД-ММ-ГГГГ или оставьте пустым."`

---

### **I: Дата публикации**
- **Тип данных:** Дата (необязательное поле).
- **Логика:**  
  Аналогично столбцу H.

---

### **J: Размещено в финальной папке**
- **Тип данных:** Да/Нет.
- **Логика:**
  1. Программа запрашивает:  
     `"Размещено в финальной папке? (1 - 'Нет', 2 - 'Да'):"`
  2. Если выбрано `1`, программа выводит:  
     `"Тогда разместите файл и потом выберите 'Да'."`  
     и повторяет запрос.
  3. Если выбрано `2`, программа переходит к следующему столбцу.
  4. Если ввод некорректный, программа выводит:  
     `"Некорректный ввод. Введите 1 (Нет) или 2 (Да)."`

---

### **K: Ссылка на Ядиск/видеохостинг**
- **Тип данных:** Ссылка (обязательно).
- **Логика:**
  1. Программа запрашивает:  
     `"Введите ссылку на Ядиск/видеохостинг:"`
  2. Программа проверяет, содержит ли ссылка символ `/`.
  3. Если символ отсутствует, программа выводит:  
     `"Ссылка должна содержать символ '/'. Попробуйте снова."`

---

### **L: Формат**
- **Тип данных:** Текст (обязательно).
- **Логика:**
  1. Программа запрашивает:  
     `"Введите формат (1 - 'Текст', 2 - 'Видео'):"`
  2. Пользователь вводит `1` или `2`, программа сохраняет значение как "Текст" или "Видео".
  3. Если ввод некорректный, программа выводит:  
     `"Некорректный ввод. Введите 1 (Текст) или 2 (Видео)."`

## **L: Пропуск столбцов M и N при формате "Видео"**
- **Тип данных:** Условный пропуск.
- **Логика:**
  1. После выбора формата в столбце **L**:
     - Если выбран `"Текст"`, программа обрабатывает столбцы M и N в соответствии с их логикой:
       - **M:** Проверка на наличие `<iframe src=`.
       - **N:** Автоматическое преобразование кода.
     - Если выбран `"Видео"`, программа пропускает обработку столбцов **M** и **N**.
  2. Сообщение:
     - При выборе `"Видео"` программа выводит:  
       `"Формат 'Видео' выбран. Столбцы 'Код внедрения' и 'Код внедрения (адаптированный)' пропускаются."`

---

### **M: Код внедрения (OneDrive, если текст)**
- **Тип данных:** HTML-код (обязательно).
- **Логика:**
  1. Программа запрашивает:  
     `"Введите код внедрения OneDrive (если текст):"`
  2. Программа проверяет, содержит ли код `<iframe src=`.
  3. Если код некорректный, программа выводит:  
     `"Введите корректный код внедрения OneDrive."`

---

### **N: Код внедрения (адаптированный для отображения)**
- **Тип данных:** Автоматическое заполнение.
- **Логика:**
  1. Программа берёт значение из столбца M.
  2. Применяет преобразования:
     - Добавляет `<p align="center">` в начало.
     - Добавляет `</p>` в конец.
     - Заменяет `width="..."` на `width="90%"`.
     - Заменяет `height="..."` на `height="1800"`.
  3. Программа выводит сообщение:  
     `"Код внедрения адаптирован для отображения на tilda."`

---

### **O: Имя страницы Tilda**
- **Тип данных:** Текст (обязательно).
- **Логика:**
  1. Программа запрашивает:  
     `"Введите имя страницы Tilda (латиница):"`
  2. Программа проверяет, чтобы поле содержало только латиницу и цифры.
  3. Если ввод некорректный, программа выводит:  
     `"Поле может содержать только латинские буквы и цифры. Попробуйте снова."`

---

### **P: Комментарий**
- **Тип данных:** Текст (необязательное поле).
- **Логика:**
  1. Программа запрашивает:  
     `"Введите комментарий (или оставьте пустым):"`
  2. Пользователь может нажать Enter, чтобы оставить поле пустым.


---

### **3.3. Подтверждение заполненных данных**
- Программа выводит все заполненные поля с их значениями.
- Спрашивает: `"Сохранить изменения? (1 - 'Да', 2 - 'Редактировать'):"`
- **Если пользователь выбирает `1`:**
  - Сохраняет запись.
  - Возвращается в меню.
- **Если пользователь выбирает `2`:**
  - Переходит в режим редактирования (см. ниже).

---

## **4. Режим редактирования**

### **4.1. Логика**
1. Программа выводит все поля записи с их текущими значениями.
2. Пользователь выбирает номер поля для редактирования.
3. После редактирования программа снова отображает все поля и спрашивает:  
 `"Сохранить изменения? (1 - 'Да', 2 - 'Редактировать'):"`
4. Если пользователь подтверждает, программа сохраняет запись.

---

### **5. Выход**
- Программа завершает выполнение с сообщением: `"До свидания!"`
